<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Habits</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Habits">
    
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzA5MDUxNCIvPjxwYXRoIGQ9Ik0yNSA1MCBsMTUgMTUgbDM1IC0zNSIgc3Ryb2tlPSIjZmZmZmZmIiBzdHJva2Utd2lkdGg9IjgiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjwvc3ZnPg==">

    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        appBg: '#090514',       
                        cardBg: '#170b33',      
                        primary: '#9d4edd',     
                        textMain: '#f3e8ff',    
                        textMuted: '#a78bfa'    
                    }
                }
            }
        }
    </script>
    <style>
        body { -webkit-user-select: none; user-select: none; -webkit-tap-highlight-color: transparent; }
        .transition-transform { transition-property: transform; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 300ms; }
        ::-webkit-scrollbar { display: none; }
        .active-tab { border-bottom: 3px solid #9d4edd; color: #f3e8ff !important; }
        .bar-anim { transition: height 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
        details summary::-webkit-details-marker { display: none; }
    </style>
</head>
<body class="bg-appBg text-textMain font-sans min-h-screen relative pb-24 overflow-x-hidden">

    <!-- Header -->
    <header class="pt-12 pb-6 px-6 sticky top-0 bg-appBg/90 backdrop-blur-md z-10 flex justify-between items-center">
        <h1 class="text-3xl font-bold tracking-tight">Habits</h1>
        <button onclick="openModal('settings-modal')" class="p-2 text-textMuted hover:text-white transition-colors">
            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
        </button>
    </header>

    <!-- Habit List -->
    <main class="px-6 space-y-4" id="habit-list"></main>

    <!-- Floating Add Button -->
    <button id="fab-add" onclick="prepareAddModal()" class="fixed bottom-8 right-6 bg-primary text-white w-14 h-14 rounded-full shadow-[0_4px_20px_rgba(157,78,221,0.5)] flex items-center justify-center hover:scale-105 active:scale-95 transition-transform z-20">
        <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
        </svg>
    </button>

    <!-- Dark Overlay -->
    <div id="modal-overlay" onclick="closeAllModals()" class="fixed inset-0 bg-black/80 z-30 hidden transition-opacity"></div>

    <!-- Plus Modal (Tabs: New Habit / Global Overview) -->
    <div id="habit-modal" class="fixed bottom-0 left-0 right-0 bg-cardBg rounded-t-3xl z-40 transform translate-y-full transition-transform border-t border-primary/30 shadow-[0_-10px_40px_rgba(157,78,221,0.15)] max-h-[90vh] overflow-y-auto">
        <div class="sticky top-0 bg-cardBg z-10 pt-4 px-6">
            <div class="w-12 h-1.5 bg-textMuted/30 rounded-full mx-auto mb-4"></div>
            <div class="flex gap-6 border-b border-primary/10 mb-6">
                <button id="tab-btn-create" onclick="switchPlusTab('create')" class="pb-3 text-lg font-bold text-textMuted active-tab">Create</button>
                <button id="tab-btn-overview" onclick="switchPlusTab('overview')" class="pb-3 text-lg font-bold text-textMuted">Overview</button>
            </div>
        </div>

        <!-- Tab 1: Create/Edit -->
        <div id="tab-content-create" class="p-6 pt-0">
            <h2 id="modal-title" class="text-sm font-bold mb-4 uppercase tracking-widest text-primary">New Habit</h2>
            <input type="hidden" id="edit-id">
            <input type="text" id="habit-name" placeholder="Name (e.g., Read Books)" class="w-full bg-appBg text-textMain border border-primary/30 rounded-xl p-4 mb-4 focus:outline-none focus:border-primary">
            <textarea id="habit-desc" placeholder="Why are you doing this? (Description)" rows="3" class="w-full bg-appBg text-textMain border border-primary/30 rounded-xl p-4 mb-4 focus:outline-none focus:border-primary"></textarea>
            <div class="bg-appBg border border-primary/30 rounded-xl p-4 mb-6">
                <label class="block text-xs text-textMuted mb-2 uppercase font-bold">Daily Target Number</label>
                <input type="number" id="habit-target" placeholder="Leave empty for yes/no" class="w-full bg-transparent text-textMain focus:outline-none text-lg">
            </div>
            <div class="flex gap-4">
                <button onclick="closeAllModals()" class="flex-1 py-4 rounded-xl font-semibold text-textMuted bg-appBg border border-primary/20">Cancel</button>
                <button onclick="saveHabitAction()" class="flex-1 py-4 rounded-xl font-semibold text-white bg-primary">Save</button>
            </div>
        </div>

        <!-- Tab 2: Global Stats -->
        <div id="tab-content-overview" class="p-6 pt-0 hidden">
            <div id="global-stats-container"></div>
        </div>
    </div>

    <!-- Individual Stats Modal -->
    <div id="stats-modal" class="fixed bottom-0 left-0 right-0 bg-cardBg rounded-t-3xl z-40 transform translate-y-full transition-transform p-6 border-t border-primary/30 shadow-[0_-10px_40px_rgba(157,78,221,0.15)] max-h-[90vh] overflow-y-auto">
        <div class="w-12 h-1.5 bg-textMuted/30 rounded-full mx-auto mb-6"></div>
        <div id="stats-content"></div>
        <button onclick="closeAllModals()" class="w-full mt-6 py-4 rounded-xl font-semibold text-white bg-primary">Close</button>
    </div>

    <!-- Settings Menu -->
    <div id="settings-modal" class="fixed bottom-0 left-0 right-0 bg-cardBg rounded-t-3xl z-40 transform translate-y-full transition-transform p-6 border-t border-primary/30">
        <div class="w-12 h-1.5 bg-textMuted/30 rounded-full mx-auto mb-6"></div>
        <h2 class="text-xl font-bold mb-6">Backup & Restore</h2>
        <div class="space-y-4 mb-6">
            <button onclick="exportData()" class="w-full py-4 rounded-xl font-semibold text-white bg-appBg border border-primary/40 flex items-center justify-center gap-2">Export .JSON</button>
            <label class="w-full py-4 rounded-xl font-semibold text-white bg-appBg border border-primary/40 flex items-center justify-center gap-2 cursor-pointer">
                Import .JSON <input type="file" id="import-file" class="hidden" accept=".json" onchange="importData(event)">
            </label>
        </div>
        <button onclick="closeAllModals()" class="w-full py-4 rounded-xl font-semibold text-textMuted bg-appBg border border-primary/20">Close</button>
    </div>

    <script>
        let habits = JSON.parse(localStorage.getItem('my_habits')) || [];
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let currentViewedHabitId = null;

        function getTodayString() {
            const d = new Date();
            return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
        }

        function saveToStorage() {
            localStorage.setItem('my_habits', JSON.stringify(habits));
        }

        // --- Navigation Logic ---
        function switchPlusTab(tab) {
            document.getElementById('tab-btn-create').classList.toggle('active-tab', tab === 'create');
            document.getElementById('tab-btn-overview').classList.toggle('active-tab', tab === 'overview');
            document.getElementById('tab-content-create').classList.toggle('hidden', tab !== 'create');
            document.getElementById('tab-content-overview').classList.toggle('hidden', tab !== 'overview');
            if (tab === 'overview') renderGlobalStats();
        }

        function changeMonth(offset) {
            currentMonth += offset;
            if (currentMonth < 0) { currentMonth = 11; currentYear--; }
            else if (currentMonth > 11) { currentMonth = 0; currentYear++; }
            renderStatsContent();
        }

        // --- Global Stats Logic ---
        function renderGlobalStats() {
            const container = document.getElementById('global-stats-container');
            if (habits.length === 0) {
                container.innerHTML = `<p class="text-center text-textMuted py-10">Add habits to see progress!</p>`;
                return;
            }

            // 1. Weekly Breakdown (Clickable Weeks)
            let weeklyBreakdownHtml = '<h3 class="text-xs font-bold text-textMuted uppercase mb-3 tracking-widest">Weekly Progress</h3><div class="space-y-2 mb-8">';
            for (let i = 0; i < 4; i++) {
                const startOfWeek = new Date();
                startOfWeek.setDate(startOfWeek.getDate() - (startOfWeek.getDay() + (i * 7)));
                
                let weekCompletions = 0;
                let dayDots = '';
                for (let d = 0; d < 7; d++) {
                    const current = new Date(startOfWeek);
                    current.setDate(current.getDate() + d);
                    const dStr = `${current.getFullYear()}-${String(current.getMonth() + 1).padStart(2, '0')}-${String(current.getDate()).padStart(2, '0')}`;
                    const doneCount = habits.filter(h => h.history.includes(dStr)).length;
                    weekCompletions += doneCount;
                    const dotColor = doneCount === habits.length ? 'bg-primary' : (doneCount > 0 ? 'bg-primary/40' : 'bg-white/5');
                    dayDots += `<div class="w-1.5 h-1.5 rounded-full ${dotColor}"></div>`;
                }

                weeklyBreakdownHtml += `
                    <details class="group bg-appBg border border-primary/10 rounded-xl overflow-hidden">
                        <summary class="list-none p-4 flex justify-between items-center cursor-pointer active:bg-primary/5">
                            <span class="text-sm font-medium">Week of ${startOfWeek.toLocaleDateString('en', {month:'short', day:'numeric'})}</span>
                            <div class="flex items-center gap-3">
                                <div class="flex gap-1">${dayDots}</div>
                                <svg class="w-4 h-4 text-textMuted group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M19 9l-7 7-7-7" /></svg>
                            </div>
                        </summary>
                        <div class="px-4 pb-4 space-y-2 border-t border-primary/5 pt-3">
                            ${generateWeekDetail(startOfWeek)}
                        </div>
                    </details>
                `;
            }
            weeklyBreakdownHtml += '</div>';

            // 2. Monthly Progress (Clickable Bars)
            let monthlyChartHtml = '<h3 class="text-xs font-bold text-textMuted uppercase mb-3 tracking-widest">Monthly Progress</h3><div class="flex justify-between items-end h-32 gap-2 bg-appBg p-4 rounded-2xl border border-primary/10 mb-4">';
            for (let i = 5; i >= 0; i--) {
                const d = new Date();
                d.setMonth(d.getMonth() - i);
                const m = d.getMonth();
                const y = d.getFullYear();
                const mName = d.toLocaleString('default', { month: 'short' });
                
                const totalCompletions = habits.reduce((acc, h) => {
                    return acc + h.history.filter(date => {
                        const [dy, dm] = date.split('-').map(Number);
                        return dy === y && dm === (m + 1);
                    }).length;
                }, 0);

                const maxPossible = habits.length * new Date(y, m + 1, 0).getDate();
                const height = maxPossible > 0 ? (totalCompletions / maxPossible) * 100 : 0;

                monthlyChartHtml += `
                    <div class="flex-1 flex flex-col items-center gap-2 h-full group cursor-pointer" onclick="showMonthDetail(${m}, ${y}, ${totalCompletions})">
                        <div class="w-full bg-primary/10 rounded-t-md relative flex items-end h-full overflow-hidden">
                            <div class="bg-primary w-full bar-anim group-hover:bg-primary/80" style="height: ${height}%"></div>
                        </div>
                        <span class="text-[10px] text-textMuted font-bold">${mName}</span>
                    </div>
                `;
            }
            monthlyChartHtml += '</div><div id="month-detail-area" class="text-center text-xs text-textMuted italic">Click a bar to see month stats</div>';

            container.innerHTML = weeklyBreakdownHtml + monthlyChartHtml;
        }

        function generateWeekDetail(startDate) {
            let html = '';
            for (let d = 0; d < 7; d++) {
                const current = new Date(startDate);
                current.setDate(current.getDate() + d);
                const dStr = `${current.getFullYear()}-${String(current.getMonth() + 1).padStart(2, '0')}-${String(current.getDate()).padStart(2, '0')}`;
                const doneCount = habits.filter(h => h.history.includes(dStr)).length;
                html += `
                    <div class="flex justify-between items-center text-xs">
                        <span class="text-textMuted">${current.toLocaleDateString('en', {weekday:'long', day:'numeric'})}</span>
                        <span class="font-bold text-primary">${doneCount} / ${habits.length} Done</span>
                    </div>
                `;
            }
            return html;
        }

        function showMonthDetail(m, y, count) {
            const mName = new Date(y, m).toLocaleString('default', { month: 'long' });
            const area = document.getElementById('month-detail-area');
            
            // Calculate Perfect Days for that month
            const daysInMonth = new Date(y, m + 1, 0).getDate();
            let perfectDays = 0;
            for (let i = 1; i <= daysInMonth; i++) {
                const dStr = `${y}-${String(m + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                if (habits.length > 0 && habits.every(h => h.history.includes(dStr))) perfectDays++;
            }

            area.innerHTML = `
                <div class="bg-primary/5 border border-primary/20 p-4 rounded-xl animate-in fade-in slide-in-from-bottom-2 duration-300">
                    <div class="text-sm font-bold text-textMain mb-1">${mName} ${y}</div>
                    <div class="flex justify-around mt-2">
                        <div><div class="text-lg font-bold text-primary">${count}</div><div class="text-[10px] uppercase">Completions</div></div>
                        <div><div class="text-lg font-bold text-primary">${perfectDays}</div><div class="text-[10px] uppercase">Perfect Days</div></div>
                    </div>
                </div>
            `;
        }

        // --- Habit List & Interaction ---
        function renderHabits() {
            const list = document.getElementById('habit-list');
            list.innerHTML = '';
            const today = getTodayString();

            habits.forEach(habit => {
                if (habit.lastUpdated !== today) { habit.progress = 0; habit.lastUpdated = today; }
                const isDone = habit.history.includes(today);
                const isCounter = habit.type === 'counter';
                
                let circleContent = isDone ? `<svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path d="M5 13l4 4L19 7" /></svg>` 
                                           : (isCounter ? `<div class="text-[10px] font-bold leading-tight">${habit.progress}<br><span class="opacity-40 border-t border-white/20 px-1">${habit.target}</span></div>` : '');

                const habitEl = document.createElement('div');
                habitEl.className = `bg-cardBg p-4 rounded-2xl border ${isDone ? 'border-primary' : 'border-primary/20'} flex items-center gap-4 relative overflow-hidden`;
                
                habitEl.innerHTML = `
                    ${isCounter && !isDone ? `<div class="absolute left-0 bottom-0 h-1 bg-primary/40 transition-all" style="width: ${(habit.progress/habit.target)*100}%"></div>` : ''}
                    <button onclick="interactHabit('${habit.id}')" class="w-12 h-12 rounded-full border-2 border-primary flex-shrink-0 flex items-center justify-center ${isDone ? 'bg-primary' : ''} active:scale-90 transition-all">${circleContent}</button>
                    <div class="flex-1 min-w-0" onclick="openStats('${habit.id}')">
                        <div class="flex items-center gap-2">
                            <h2 class="font-bold truncate ${isDone ? 'text-textMuted line-through' : ''}">${habit.name}</h2>
                            ${getStreak(habit.history) > 0 ? `<span class="text-[10px] font-bold text-orange-400 bg-orange-400/10 px-2 py-0.5 rounded-full">ðŸ”¥ ${getStreak(habit.history)}</span>` : ''}
                        </div>
                        <p class="text-xs text-textMuted truncate">${habit.desc || 'Tap for details'}</p>
                    </div>
                    <button onclick="prepareEditModal('${habit.id}')" class="p-2 text-textMuted/40 active:scale-90">
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                    </button>
                `;
                list.appendChild(habitEl);
            });
            saveToStorage();
        }

        function interactHabit(id) {
            const h = habits.find(x => x.id === id);
            const t = getTodayString();
            if (h.history.includes(t)) {
                h.history = h.history.filter(d => d !== t); h.progress = 0;
            } else {
                if (h.type === 'counter') {
                    h.progress++; if (h.progress >= h.target) h.history.push(t);
                } else { h.history.push(t); }
            }
            renderHabits();
        }

        // --- Individual Stats Modal ---
        function openStats(id) {
            currentViewedHabitId = id;
            currentMonth = new Date().getMonth();
            currentYear = new Date().getFullYear();
            renderStatsContent();
            openModal('stats-modal');
        }

        function renderStatsContent() {
            const habit = habits.find(h => h.id === currentViewedHabitId);
            const content = document.getElementById('stats-content');
            
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const monthName = new Date(currentYear, currentMonth).toLocaleString('default', { month: 'long' });

            let calHtml = `<div class="grid grid-cols-7 gap-1 text-center text-[10px] text-textMuted mb-2">`;
            ['S','M','T','W','T','F','S'].forEach(d => calHtml += `<div>${d}</div>`);
            calHtml += `</div><div class="grid grid-cols-7 gap-1">`;
            for (let i = 0; i < firstDay; i++) calHtml += `<div></div>`;
            for (let i = 1; i <= daysInMonth; i++) {
                const dStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                const done = habit.history.includes(dStr);
                const isToday = dStr === getTodayString();
                calHtml += `<div class="aspect-square rounded flex items-center justify-center text-xs ${done ? 'bg-primary text-white font-bold' : (isToday ? 'border border-primary text-primary' : 'bg-appBg border border-primary/5 text-textMuted')}">${i}</div>`;
            }
            calHtml += `</div>`;

            content.innerHTML = `
                <h2 class="text-2xl font-bold mb-2">${habit.name}</h2>
                ${habit.desc ? `<div class="bg-primary/5 border border-primary/10 p-4 rounded-xl text-sm leading-relaxed mb-6 whitespace-pre-wrap text-textMain/90">${habit.desc}</div>` : ''}
                
                <div class="flex justify-between items-center mb-4">
                    <button onclick="changeMonth(-1)" class="p-2 text-primary">&larr;</button>
                    <span class="font-bold">${monthName} ${currentYear}</span>
                    <button onclick="changeMonth(1)" class="p-2 text-primary">&rarr;</button>
                </div>
                <div class="bg-appBg p-4 rounded-2xl border border-primary/10 mb-6">${calHtml}</div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-appBg p-4 rounded-2xl border border-primary/10 text-center">
                        <div class="text-xl font-bold">ðŸ”¥ ${getStreak(habit.history)}</div>
                        <div class="text-[10px] uppercase text-textMuted">Streak</div>
                    </div>
                    <button onclick="deleteHabit('${habit.id}')" class="bg-red-500/10 p-4 rounded-2xl border border-red-500/20 text-center text-red-400 font-bold text-sm">Delete</button>
                </div>
            `;
        }

        // --- Action Functions ---
        function prepareAddModal() {
            switchPlusTab('create');
            document.getElementById('modal-title').innerText = "New Habit";
            document.getElementById('edit-id').value = "";
            document.getElementById('habit-name').value = "";
            document.getElementById('habit-desc').value = "";
            document.getElementById('habit-target').value = "";
            openModal('habit-modal');
        }

        function prepareEditModal(id) {
            const h = habits.find(x => x.id === id);
            switchPlusTab('create');
            document.getElementById('modal-title').innerText = "Edit Habit";
            document.getElementById('edit-id').value = h.id;
            document.getElementById('habit-name').value = h.name;
            document.getElementById('habit-desc').value = h.desc;
            document.getElementById('habit-target').value = h.target || "";
            openModal('habit-modal');
        }

        function saveHabitAction() {
            const id = document.getElementById('edit-id').value;
            const name = document.getElementById('habit-name').value.trim();
            const desc = document.getElementById('habit-desc').value.trim();
            const target = document.getElementById('habit-target').value;
            if (!name) return;
            const isCounter = target !== '' && Number(target) > 0;

            if (id) {
                const h = habits.find(x => x.id === id);
                h.name = name; h.desc = desc; h.type = isCounter ? 'counter' : 'boolean'; h.target = isCounter ? Number(target) : null;
            } else {
                habits.push({ id: Date.now().toString(), name, desc, type: isCounter ? 'counter' : 'boolean', target: isCounter ? Number(target) : null, progress: 0, history: [], lastUpdated: getTodayString() });
            }
            renderHabits(); closeAllModals();
        }

        function deleteHabit(id) {
            if (confirm("Delete this habit?")) { habits = habits.filter(x => x.id !== id); renderHabits(); closeAllModals(); }
        }

        function getStreak(hist) {
            let s = 0; let d = new Date(); if (!hist.includes(getTodayString())) d.setDate(d.getDate()-1);
            while(hist.includes(`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`)) { s++; d.setDate(d.getDate()-1); }
            return s;
        }

        // --- Modal Helpers ---
        function openModal(id) {
            document.getElementById('modal-overlay').classList.remove('hidden');
            setTimeout(() => document.getElementById(id).classList.remove('translate-y-full'), 10);
        }
        function closeAllModals() {
            document.querySelectorAll('[id$="-modal"]').forEach(m => m.classList.add('translate-y-full'));
            setTimeout(() => document.getElementById('modal-overlay').classList.add('hidden'), 300);
        }
        function exportData() { const blob = new Blob([JSON.stringify(habits)], {type: "application/json"}); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = "habits.json"; a.click(); }
        function importData(e) { const fr = new FileReader(); fr.onload = (x) => { habits = JSON.parse(x.target.result); renderHabits(); closeAllModals(); }; fr.readAsText(e.target.files[0]); }

        renderHabits();
    </script>
</body>
</html>
